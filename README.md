# تفاوت جامع بین JWT و OAuth
## 🔷 معرفی **JWT (JSON Web Token)** 

یک فرمت توکن سبک و قابل رمزنگاری است که برای احراز هویت (Authentication) و انتقال اطلاعات بین سیستم‌ها استفاده می‌شود.


- اطلاعات داخل توکن قرار دارد (مثلاً user_id، role و ...).
- قابلیت امضا با کلید متقارن (HS256) یا نامتقارن (RS256) را دارد.
- بدون نیاز به دیتابیس، می‌توان اطلاعات را تأیید کرد.

---

## 🔶 معرفی **OAuth2**

درواقع **OAuth2** یک پروتکل کامل برای مجوزدهی (Authorization) است که به اپلیکیشن‌های شخص ثالث اجازه می‌دهد بدون دسترسی به رمز عبور، به منابع کاربر در یک سرویس‌دهنده (مثلاً گوگل یا فیسبوک) دسترسی داشته باشند.

- شامل Flowهای مختلفی مثل Authorization Code، Implicit، Password و Client Credentials است.
- توکن‌هایی که ایجاد می‌کند می‌توانند JWT یا opaque (غیر قابل خواندن) باشند.
- بیشتر برای اتصال اپلیکیشن‌ها به یکدیگر استفاده می‌شود.

---

## 🎯 تفاوت‌های کلیدی بین JWT و OAuth2

| ویژگی                        | JWT (فرمت توکن)                  | OAuth2 (پروتکل مجوزدهی)                     |
|-----------------------------|----------------------------------|---------------------------------------------|
| نوع                         | 📦 فرمت توکن                     | 📡 پروتکل کامل برای مجوزدهی                 |
| وظیفه اصلی                 | احراز هویت (Authentication)     | مجوزدهی (Authorization)                    |
| استفاده عمومی              | API Token، سشن‌های بدون state   | دسترسی امن به اطلاعات کاربر توسط اپ ثالث   |
| قابلیت امضا                | ✅ بله (HS256/RS256)             | ✅ در صورت استفاده از JWT                   |
| Stateless بودن              | ✅ بله                            | ❌ بستگی به نوع توکن دارد                   |
| Revocation (ابطال توکن)     | ❌ ندارد (نیاز به لیست دستی)     | ✅ دارد (Refresh Token, Revoke Endpoint)    |
| قابلیت انقضا (Expiration)   | ✅ بله                            | ✅ بله                                       |
| سادگی پیاده‌سازی           | ✅ ساده                          | ❌ پیچیده‌تر                                |
| مناسب برای اپ موبایل/وب   | ✅ بله                            | ✅ بله                                       |
| ارتباط با اپ ثالث           | ❌ نه                            | ✅ بله (ویژه این مورد است)                  |

---


به بیان دیگر:

  ا JWT فقط یک فرمت برای توکن‌هاست.
  
  اا OAuth2 از توکن‌ها برای انتقال مجوز استفاده می‌کند، و گاهی اوقات آن‌ها را به صورت JWT تولید می‌کند.

---

## 📦 مثال کاربردی:

### JWT:
- کاربر لاگین می‌کند.
- سرور یک JWT تولید می‌کند و به کاربر می‌دهد.
- کاربر در هر درخواست، JWT را ارسال می‌کند.
- سرور بدون نیاز به دیتابیس، اطلاعات کاربر را از روی JWT استخراج می‌کند.

### OAuth2:
- کاربر وارد اپ می‌شود و می‌خواهد با گوگل لاگین کند.
- اپ از گوگل درخواست توکن می‌کند.
- گوگل، پس از تأیید کاربر، یک Access Token می‌دهد.
- این توکن می‌تواند JWT باشد یا یک توکن opaque.
- اپ با این توکن اطلاعات کاربر را از گوگل دریافت می‌کند.

---

## ✅ مقایسه روش ها :

# جدول مقایسه JWT (HS و RS)، OAuth2 و RSA Authentication

| ویژگی‌ها                             | JWT (HS256 - متقارن)          | JWT (RS256 - نامتقارن)           | OAuth2                               | RSA Authentication (با کلید عمومی/خصوصی) |
|--------------------------------------|--------------------------------|----------------------------------|--------------------------------------|--------------------------------------------|
| **نوع امضا / اعتبارسنجی**            | کلید متقارن (secret key)      | کلید عمومی/خصوصی (RSA)          | بستگی به پیاده‌سازی (JWT یا opaque) | امضای پیام با کلید خصوصی                    |
| **Stateless بودن**                   | ✅ بله                         | ✅ بله                           | ✅ در بیشتر Flowها                   | ✅ بله                                       |
| **نیاز به سرور مرکزی**              | ❌ ندارد                      | ❌ ندارد                        | ✅ دارد (Authorization Server)       | ❌ فقط برای ذخیره کلید عمومی                |
| **امنیت در برابر جعل توکن**         | ⚠️ نسبتاً خوب (وابسته به secret) | ✅ بالا                          | ✅ بالا                              | ✅ بسیار بالا                               |
| **مناسب برای microservices**        | ✅ بله                         | ✅ عالی (توکن قابل verify با public key) | ✅ بله                        | ⚠️ نه به خوبی JWT                           |
| **استفاده در سیستم‌های توزیع‌شده**  | ⚠️ مشکل در اشتراک secret      | ✅ بله                           | ✅ با تنظیمات مناسب                  | ⚠️ نیاز به اشتراک کلید عمومی               |
| **قابلیت انقضا (expiration)**       | ✅ دارد                        | ✅ دارد                          | ✅ دارد                              | ❌ ندارد (مگر با سیاست خارجی)              |
| **ذخیره‌سازی کلاینتی**              | ✅ در localStorage / cookie    | ✅ مشابه                        | ✅ معمولاً از طریق Token Storage     | ❌ نه به صورت توکن                          |
| **پیچیدگی پیاده‌سازی**              | ✅ ساده                       | ⚠️ متوسط                        | ❌ پیچیده                            | ⚠️ متوسط تا زیاد                           |
| **پرفرمنس سرور در اعتبارسنجی**      | ✅ سریع                       | ✅ سریع (نیاز به پردازش RSA)    | ⚠️ وابسته به flow                   | ✅ سریع (در verify امضا)                    |
| **قابلیت ابطال توکن (Revoke)**      | ❌ نه به صورت داخلی           | ❌ نه به صورت داخلی             | ✅ دارد (با Refresh/Revocation)      | ❌ ندارد (مگر با لیست دستی)                |
| **امنیت کلید سمت سرور**             | ⚠️ حساس به نشت کلید           | ✅ امن‌تر (private فقط روی سرور) | ✅ خوب، با مدیریت کلید مناسب         | ✅ عالی                                     |
| **مناسب برای احراز هویت ساده API**  | ✅ بله                         | ✅ بله                           | ❌ نه (برای delegation مناسب‌تر است) | ✅ بله                                       |
| **مناسب برای دسترسی از طرف اپ ثالث**| ❌ نه                         | ❌ نه                            | ✅ بله (ویژه این مورد است)           | ❌ نه                                       |
| **پشتیبانی از سطوح دسترسی/Scope**   | ⚠️ دستی                       | ⚠️ دستی                         | ✅ بله (Scopes, Roles, Permissions)  | ❌ نه                                       |
| **قابلیت استفاده در موبایل/وب**     | ✅ بله                         | ✅ بله                           | ✅ بله                               | ✅ با تنظیمات بیشتر                        |
| **نیاز به زیرساخت Key Management**  | ❌ ندارد                      | ✅ بله (مدیریت کلید عمومی/خصوصی) | ✅ بله (Authorization Server)        | ✅ بله (ذخیره و مپ کلیدها)                  |




---
مطالعه بیشتر :

https://sokanacademy.com/plus/hrmadani/%D8%A7%D8%AD%D8%B1%D8%A7%D8%B2-%D9%87%D9%88%DB%8C%D8%AA-%D8%AF%D8%B1-%D9%85%DB%8C%DA%A9%D8%B1%D9%88%D8%B3%D8%B1%D9%88%DB%8C%D8%B3-%D8%AA%DA%A9%D9%86%DB%8C%DA%A9-%D9%87%D8%A7-%D9%88-%D8%B1%D9%88%D8%B4-
%D9%87%D8%A7?utm_source=chatgpt.com



benchmark :

https://github.com/pascaldekloe/jwt

https://pyjwt.readthedocs.io/en/stable/


کتابخانه های پیاده سازی در پایتون :

cryptography

https://pyjwt.readthedocs.io/en/latest/usage.html


نمونه پیاده سازی با استفاده از RSA :

https://elc.github.io/python-security/chapters/10_JSON_Web_Tokens.html


مقایسه روش های رمزگذاری در JWT :

https://security.stackexchange.com/questions/194830/recommended-asymmetric-algorithms-for-jwt#answer-194834

https://www.rfc-editor.org/rfc/rfc7518#section-3



پیاده سازی JWT با استفاده از pyjwt : 

https://blog.marzeta.pl/python-and-jwt-a-comprehensive-guide-to-secure-sessions/

پیاده سازی RSA در JWT :

https://asecuritysite.com/jwt/jwt_python_rsa

https://elc.github.io/python-security/chapters/10_JSON_Web_Tokens.html

https://github.com/mosquito/pyjwt-rsa

